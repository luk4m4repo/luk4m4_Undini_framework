# Undini Pipeline: Quick Reference

## What is this?
A set of Python scripts that automate the process of exporting, processing, and importing assets (meshes, splines, blueprints) between Unreal Engine and Houdini, making procedural content generation and asset management much faster and more reliable.

---

## Pipeline Overview

**Choose ONE starting method:**
- **A. Spline Workflow:**
  → `000_export_splines_as_json.py` (Export splines from UE to JSON)
- **B. GenZone Mesh Workflow:**
  → `010_export_gz_to_mod.py` (Export GenZone meshes from UE to FBX)

➡️ **After A or B:**
**→ Make sure the widget checkbox matches your chosen method (A or B)!**

**Then continue:**
- `100_headless_topnet_PCGHD.py` (Houdini: generate buildings)
- `110_reimport_datatable.py` (Import CSV as UE datatables)
- `120_create_pcg_graph.py` (Duplicate PCG Blueprint, spawn in level)

**Alternate branch (after A or B):**
- `120_create_pcg_graph.py`
  → `200_headless_topnet_SWR.py` (Houdini: sidewalks/roads)
  → `210_reimport_SM.py` (Import static meshes)
  → `220_add_SM_to_lvl.py` (Add meshes to level)

---


1. **Export** (Steps 1-2)
   - Export splines from Unreal to JSON (000_export_splines_as_json.py)
   - Export static meshes (genzones) from Unreal to FBX (010_export_gz_to_mod.py)
2. **Process in Houdini** (Steps 3, 6)
   - Generate building data in Houdini (100_headless_topnet_PCGHD.py)
   - Generate sidewalks and roads in Houdini (200_headless_topnet_SWR.py)
3. **Import & Setup in Unreal** (Steps 4-5, 7-8)
   - Reimport CSV data as datatables (110_reimport_datatable.py)
   - Create PCG graphs in the level (120_create_pcg_graph.py)
   - Reimport static meshes from FBX (210_reimport_SM.py)
   - Add sidewalks and roads to the level (220_add_SM_to_lvl.py)

---

## Using Your Own Houdini Files

You can use custom Houdini `.hip` files for city, sidewalk, and road generation.

- **Templates Provided:**
  - Template HIP files are in `../04_Houdini/` with all required nodes and parameters. Start with these if unsure!
- **Where to put HIP files:**
  - Place your `.hip` files in `lcroisez_Undini_framework/04_Houdini/` (or provide the full path in the widget/script).
- **Required for City (PCGHD):**
  - A TOP network (`/obj/geo1/topnet`)
  - `/obj/geo1/pcg_export1` with `file_mesh` and `file_mat` parameters
  - `/obj/geo1/python_import_splines_from_json` with `iteration_number` and `base_path`
  - `/obj/geo1/switch_bool` to switch input type
  - Outputs: mesh/material CSVs
- **Required for Sidewalks/Roads (SWR):**
  - A TOP network (`/obj/geo1/topnet`)
  - `/obj/geo1/rop_fbx_road` and `/obj/geo1/rop_fbx_sidewalks` with `sopoutput`
  - `/obj/geo1/python_import_splines_from_json` with `iteration_number` and `base_path`
  - `/obj/geo1/switch_bool` to control network
  - Outputs: road/sidewalk FBXs
- **How to reference:**
  - In the widget or script, set the HIP file path before running the Houdini step.
- **Troubleshooting:**
  - Errors about missing nodes/parameters? Compare your HIP to the template and this doc.
  - Check logs for the exact names the pipeline is trying to set.

---

## Key Scripts & Roles

- **999_UE_manager.py**: Orchestrates the whole pipeline (calls all other scripts in sequence)
- **000_export_splines_as_json.py**: Exports all spline actors to JSON for Houdini processing
- **010_export_gz_to_mod.py**: Exports static meshes (genzones) to FBX for Houdini processing
- **100_headless_topnet_PCGHD.py**: Runs Houdini to process exported assets and generate building data (CSV)
- **110_reimport_datatable.py**: Reimports CSVs as Unreal datatables for PCG graphs
- **120_create_pcg_graph.py**: Duplicates a PCG Blueprint and spawns it in the level for building generation
- **200_headless_topnet_SWR.py**: Runs Houdini to generate sidewalks and roads (FBX)
- **210_reimport_SM.py**: Reimports static meshes from FBX files generated by Houdini
- **220_add_SM_to_lvl.py**: Adds sidewalk/road meshes to the level and organizes them in folders

---

## File & Asset Flow (Simplified)

```plaintext
- PCG HD
[Unreal Static Meshes or Splines] ──▶ (FBX export or JSON export) ──▶ [Houdini] ──▶ (CSV out) ──▶ [Unreal reimport]

- SW & Roads
[Unreal Static Meshes or Splines] ──▶ (FBX export or JSON export) ──▶ [Houdini] ──▶ (FBX out) ──▶ [Unreal reimport]

- Add to level
[BP Template] ──▶ (duplicate/instance) ──▶ [Level]
```

- All files are organized and versioned by iteration number.
- Naming conventions are important for automation.

---

## Main Principles
- **Automate everything possible.**
- **Follow naming conventions** for assets/files.
- **Scripts are modular**: manager script calls each step.
- **Minimal manual intervention**: user only triggers steps and checks outputs.
- **Logs and folders** keep things organized and debuggable.

---

## See also
- [Full Documentation](./019_UE_manager_doc.md)

